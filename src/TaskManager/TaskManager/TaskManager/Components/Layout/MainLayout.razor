@using TaskManager.Services
@* Components/Layout/MainLayout.razor *@
@inherits LayoutComponentBase
@inject IAuthService AuthService
@inject NavigationManager Navigation

<div class="app-layout">
    <!-- SIDEBAR - All interactions handled in NavMenu -->
    <NavMenu />

    <!-- MAIN CONTENT -->
    <main class="app-main">
        <!-- Content Header -->
        <header class="content-header">
            <h2 class="page-title">Project: @projectName</h2>

            <div class="header-actions">
                <button class="icon-btn" title="Info">
                    <span>ℹ️</span>
                </button>

                <button class="icon-btn" title="Notifications">
                    <span>🔔</span>
                    @if (notificationCount > 0)
                    {
                        <span class="notification-badge"></span>
                    }
                </button>

                <button class="btn btn-primary">
                    Add Task
                </button>
            </div>
        </header>

        <!-- Page Content -->
        <div class="content-body">
            @Body
        </div>
    </main>
</div>

<style>
    /* APP LAYOUT */
    .app-layout {
        display: flex;
        min-height: 100vh;
        background: var(--bg-main);
    }

    /* MAIN CONTENT */
    .app-main {
        flex: 1;
        margin-left: var(--sidebar-width);
        transition: margin-left 0.3s ease;
        display: flex;
        flex-direction: column;
    }

    .sidebar-collapsed .app-main {
        margin-left: var(--sidebar-collapsed-width);
    }

    /* CONTENT HEADER */
    .content-header {
        background: transparent;
        padding: var(--space-xl);
        padding-bottom: var(--space-lg);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .page-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-primary);
        margin: 0;
    }

    .header-actions {
        display: flex;
        align-items: center;
        gap: var(--space-md);
    }

    /* CONTENT BODY */
    .content-body {
        flex: 1;
        padding: 0 var(--space-xl) var(--space-xl);
    }

    /* RESPONSIVE */
    @@media (max-width: 1024px) {
        .app-main {
            margin-left: 0;
        }
    }
</style>

@code {
    private string projectName = "Nebula Launch";
    private int notificationCount = 3;

    protected override async Task OnInitializedAsync()
    {
        var user = await AuthService.GetCurrentUserAsync();
        // Any initialization logic
    }
}